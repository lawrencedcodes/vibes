(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[820],{1164:(e,s,a)=>{Promise.resolve().then(a.bind(a,3269))},6046:(e,s,a)=>{"use strict";var t=a(6658);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}})},3269:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var t=a(5155),i=a(2115),r=a(6046),l=a(8291);function d(){let e=(0,r.useRouter)(),s=(0,l.Ht)(),[a,d]=(0,i.useState)([]),[n,m]=(0,i.useState)(!0),[c,o]=(0,i.useState)(""),[x,h]=(0,i.useState)(""),[u,f]=(0,i.useState)({day_of_week:"0",start_time:"09:00",end_time:"17:00"}),[y,g]=(0,i.useState)(!1),j=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];(0,i.useEffect)(()=>{if(!s){e.push("/login");return}(async()=>{try{let e=await fetch("/api/profile");if(!e.ok)throw Error("Failed to fetch profile data");let s=await e.json();d(s.availability||[]),m(!1)}catch(e){o(e.message),m(!1)}})()},[e,s]);let v=e=>{let{name:s,value:a}=e.target;f(e=>({...e,[s]:a}))},b=async e=>{if(e.preventDefault(),o(""),h(""),u.start_time>=u.end_time){o("Start time must be before end time");return}g(!0);try{let e=await fetch("/api/profile/availability",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({day_of_week:parseInt(u.day_of_week),start_time:u.start_time,end_time:u.end_time})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to add availability");let a=await fetch("/api/profile"),t=await a.json();d(t.availability||[]),h("Availability added successfully")}catch(e){o(e.message)}finally{g(!1)}},p=async e=>{o(""),h("");try{let s=await fetch("/api/profile/availability?day_of_week=".concat(e),{method:"DELETE"}),t=await s.json();if(!s.ok)throw Error(t.error||"Failed to remove availability");d(a.filter(s=>s.day_of_week!==e)),h("Availability removed successfully")}catch(e){o(e.message)}};return n?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("p",{className:"text-lg text-gray-600",children:"Loading availability..."})})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Your Availability"}),(0,t.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Back to Dashboard"})]})})}),(0,t.jsx)("main",{children:(0,t.jsx)("div",{className:"mx-auto max-w-7xl py-6 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,t.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,t.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[c&&(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-4 mb-6",children:(0,t.jsx)("div",{className:"flex",children:(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,t.jsx)("p",{children:c})})]})})}),x&&(0,t.jsx)("div",{className:"rounded-md bg-green-50 p-4 mb-6",children:(0,t.jsx)("div",{className:"flex",children:(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-green-700",children:(0,t.jsx)("p",{children:x})})]})})}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Set Your Availability"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:(null==s?void 0:s.role)==="teacher"?"Set the times when you are available to teach.":"Set the times when you are available to learn."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-md font-medium text-gray-700",children:"Your Current Availability"}),0===a.length?(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"You haven't set any availability yet."}):(0,t.jsx)("ul",{className:"mt-3 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,t.jsxs)("li",{className:"col-span-1 bg-white rounded-lg shadow divide-y divide-gray-200",children:[(0,t.jsx)("div",{className:"w-full flex items-center justify-between p-6 space-x-6",children:(0,t.jsxs)("div",{className:"flex-1 truncate",children:[(0,t.jsx)("div",{className:"flex items-center space-x-3",children:(0,t.jsx)("h3",{className:"text-gray-900 text-sm font-medium truncate",children:j[e.day_of_week]})}),(0,t.jsxs)("p",{className:"mt-1 text-gray-500 text-sm truncate",children:[e.start_time," - ",e.end_time]})]})}),(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"-mt-px flex divide-x divide-gray-200",children:(0,t.jsx)("div",{className:"w-0 flex-1 flex",children:(0,t.jsx)("button",{onClick:()=>p(e.day_of_week),className:"relative -mr-px w-0 flex-1 inline-flex items-center justify-center py-4 text-sm text-red-700 font-medium border border-transparent rounded-bl-lg hover:text-red-500",children:"Remove"})})})})]},e.day_of_week))})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,t.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-4",children:"Add Availability"}),(0,t.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"day_of_week",className:"block text-sm font-medium text-gray-700",children:"Day of Week"}),(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)("select",{id:"day_of_week",name:"day_of_week",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:u.day_of_week,onChange:v,required:!0,children:j.map((e,s)=>(0,t.jsx)("option",{value:s,children:e},s))})})]}),(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"start_time",className:"block text-sm font-medium text-gray-700",children:"Start Time"}),(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)("input",{type:"time",id:"start_time",name:"start_time",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:u.start_time,onChange:v,required:!0})})]}),(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{htmlFor:"end_time",className:"block text-sm font-medium text-gray-700",children:"End Time"}),(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)("input",{type:"time",id:"end_time",name:"end_time",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:u.end_time,onChange:v,required:!0})})]})]}),(0,t.jsx)("div",{className:"pt-5",children:(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",disabled:y,className:"ml-3 inline-flex justify-center rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-indigo-400",children:y?"Adding...":"Add Availability"})})})]})]})]})]})})})})})]})}},8291:(e,s,a)=>{"use strict";function t(){return{userId:1,email:"user@example.com",role:"learner",firstName:"Demo",lastName:"User"}}a.d(s,{Ht:()=>t})}},e=>{var s=s=>e(e.s=s);e.O(0,[441,517,358],()=>s(1164)),_N_E=e.O()}]);