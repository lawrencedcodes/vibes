(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[173],{2955:(e,s,t)=>{Promise.resolve().then(t.bind(t,7666))},6046:(e,s,t)=>{"use strict";var i=t(6658);t.o(i,"useParams")&&t.d(s,{useParams:function(){return i.useParams}}),t.o(i,"useRouter")&&t.d(s,{useRouter:function(){return i.useRouter}})},7666:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var i=t(5155),n=t(2115),r=t(6046),a=t(8291),o=t(8173),c=t.n(o);function d(){let e=(0,r.useRouter)(),s=(0,a.Ht)(),[t,o]=(0,n.useState)([]),[d,l]=(0,n.useState)(!0),[x,h]=(0,n.useState)("");(0,n.useEffect)(()=>{if(!s){e.push("/login");return}(async()=>{try{let e=await fetch("/api/notifications");if(!e.ok)throw Error("Failed to fetch notifications");let s=await e.json();o(s.notifications||[]),l(!1)}catch(e){h(e.message),l(!1)}})()},[e,s]);let m=async e=>{try{if(!(await fetch("/api/notifications",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notification_id:e})})).ok)throw Error("Failed to mark notification as read");o(t.map(s=>s.id===e?{...s,is_read:1}:s))}catch(e){h(e.message)}},u=e=>new Date(e).toLocaleString(),f=e=>{switch(e){case"connection_request":return(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,i.jsx)("svg",{className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 13V19M18 16H13M6 16H8M6 12H15M6 8H8"})})})});case"connection_accepted":return(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,i.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})});case"connection_rejected":return(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"h-10 w-10 rounded-full bg-red-100 flex items-center justify-center",children:(0,i.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})});case"message_received":return(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center",children:(0,i.jsx)("svg",{className:"h-6 w-6 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})})});default:return(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:(0,i.jsx)("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})})}},g=e=>"connection_request"===e.type&&(null==s?void 0:s.role)==="teacher"?(0,i.jsx)(c(),{href:"/connections",className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"View Request"}):"connection_accepted"===e.type?(0,i.jsx)(c(),{href:"/messages/".concat(e.connection_id),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Message"}):"message_received"===e.type?(0,i.jsx)(c(),{href:"/messages/".concat(e.connection_id),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Reply"}):null;return d?(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("p",{className:"text-lg text-gray-600",children:"Loading notifications..."})})}):(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,i.jsx)("header",{className:"bg-white shadow",children:(0,i.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Notifications"}),(0,i.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Back to Dashboard"})]})})}),(0,i.jsx)("main",{children:(0,i.jsx)("div",{className:"mx-auto max-w-7xl py-6 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[x&&(0,i.jsx)("div",{className:"rounded-md bg-red-50 p-4 mb-6",children:(0,i.jsx)("div",{className:"flex",children:(0,i.jsxs)("div",{className:"ml-3",children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,i.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,i.jsx)("p",{children:x})})]})})}),0===t.length?(0,i.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,i.jsxs)("div",{className:"px-4 py-5 sm:p-6 text-center",children:[(0,i.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"No Notifications"}),(0,i.jsx)("div",{className:"mt-2 max-w-xl text-sm text-gray-500 mx-auto",children:(0,i.jsx)("p",{children:"You don't have any notifications yet."})})]})}):(0,i.jsx)("div",{className:"overflow-hidden bg-white shadow sm:rounded-lg",children:(0,i.jsx)("ul",{className:"divide-y divide-gray-200",children:t.map(e=>(0,i.jsx)("li",{className:"p-4 ".concat(e.is_read?"bg-white":"bg-blue-50"),children:(0,i.jsxs)("div",{className:"flex items-start space-x-4",children:[f(e.type),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.content}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:u(e.created_at)})]}),(0,i.jsxs)("div",{className:"flex-shrink-0 flex items-center space-x-2",children:[!e.is_read&&(0,i.jsx)("button",{onClick:()=>m(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Mark as read"}),g(e)]})]})},e.id))})})]})})})]})}},8291:(e,s,t)=>{"use strict";function i(){return{userId:1,email:"user@example.com",role:"learner",firstName:"Demo",lastName:"User"}}t.d(s,{Ht:()=>i})}},e=>{var s=s=>e(e.s=s);e.O(0,[554,441,517,358],()=>s(2955)),_N_E=e.O()}]);